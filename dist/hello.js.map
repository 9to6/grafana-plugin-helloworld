{"version":3,"sources":["../src/hello.js"],"names":["PanelCtrl","panelDefaults","method","baseUrl","url","errorMode","appName","appId","HelloCtrl","$scope","$injector","$http","_","defaults","panel","events","on","onInitEditMode","bind","onPanelTeardown","render","initData","console","log","addEditorTab","pluginId","panelTabIndex","scope","elem","ret","getStackInfo","then","getApps","ondemandApps","stack","response","data","stack_id","stackZones","catch","err","app","name","length","app_id","Array","appGroup","type","push","error","warn","index","appID","body","JSON","stringify","templateUrl"],"mappings":"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","file":"hello.js","sourcesContent":["import {PanelCtrl} from 'app/plugins/sdk';\n\nconst panelDefaults = {\n  method: 'GET',\n  baseUrl: 'http://localhost:8080',\n  url: 'http://localhost:8080/v1/apps',\n  errorMode: 'show',\n\tappName: 'DVR_FG1',\n\tappId: ''\n}\n\nexport class HelloCtrl extends PanelCtrl {\n  constructor($scope, $injector, $http) {\n    super($scope, $injector)\n\t\tthis.$http = $http\n    _.defaults(this.panel, panelDefaults)\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this))\n    this.events.on('panel-teardown', this.onPanelTeardown.bind(this))\n    this.events.on('panel-initialized', this.render.bind(this))\n\t\tthis.initData()\n  }\n\n  onInitEditMode() {\n\t\tconsole.log('entering edit mode')\n    this.addEditorTab('Options', 'public/plugins/' + this.pluginId + '/editor.html', 2)\n  }\n\n  onPanelTeardown() {\n\t\tconsole.log('teared down')\n  }\n\n\tinitData() {\n\t\tthis.panelTabIndex = 0\n\t}\n\n  link(scope, elem) {\n\t\tconsole.log('link')\n\t\tconsole.log(scope)\n\t\tconsole.log(elem)\n\n\t\tlet ret = this.getStackInfo()\n\t\tret.then(() => {\n\t\t\tthis.getApps().then(() => {\n\t\t\t\tconsole.log(this.ondemandApps)\n\t\t\t})\n\t\t})\n\n  }\n\n\tgetStackInfo() {\n\t\treturn this.$http({\n        method: 'GET',\n        url: `${this.panel.baseUrl}/v1/stacks`\n      }).then(response => {\n\t\t\t\tthis.stack = response.data[0]\n\t\t\t}).then(() => {\n\t\t\t\treturn this.$http({\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\turl: `${this.panel.baseUrl}/v1/stacks/${this.stack.stack_id}/zones`\n\t\t\t\t})\n\t\t\t}).then(response => {\n\t\t\t\tthis.stackZones = response.data\n\t\t\t}).catch(err => {\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t}\n\n\tgetApps() {\n\t\treturn this.$http({\n\t\t\t\tmethod: 'GET', \n        url: `${this.panel.baseUrl}/v1/apps`\n\t\t\t}).then( response => {\n\t\t\t\tvar data = response.data\n\t\t\t\tfor(let app of data) {\n\t\t\t\t\tif (this.panel.appName == app.name) {\n\t\t\t\t\t\tconsole.log(app.name)\n\t\t\t\t\t\tthis.app = app\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconsole.log(data.length)\n\t\t\t}).then(() => {\n\t\t\t\treturn this.$http({\n\t\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\t\turl: `${this.panel.baseUrl}/v1/apps/${this.app.app_id}/groups`\n\t\t\t\t\t})\n\t\t\t}).then((response) => {\n\t\t\t\tvar data = response.data\n\t\t\t\tlet ondemandApps = new Array()\n\t\t\t\tfor(let appGroup of data) {\n\t\t\t\t\tif (appGroup.type == 'ondemand') {\n\t\t\t\t\t\tondemandApps.push(appGroup)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.ondemandApps = ondemandApps\n\t\t\t}).catch(err => {\n\t\t\t\tthis.error = err //.data.error + \" [\"+err.status+\"]\";\n\t\t\t\tconsole.warn('error', err)\n\t\t\t})\n\t}\n\n\tchangePanelTab(index) {\n\t\tconsole.log(\"index: \" + index)\n\t\tconsole.log(\"ctrl.panelTabIndex:\" + this.panelTabIndex)\n\t\tthis.panelTabIndex = index\n\t}\n\n\tupdatePanel(app) {\n\t\tthis.app = app\n\t\tthis.appID = app.app_id\n\t\tconsole.log(app.app_id)\n\n\t\tthis.$http({\n        method: this.panel.method,\n        url: `${this.panel.baseUrl}/v1/apps/${this.appID}/groups`\n      }).then( response => {\n        var data = response.data\n\t\t\t\tlet ondemandApps = new Array()\n\t\t\t\tfor(let appGroup of data) {\n\t\t\t\t\tif (appGroup.type == 'ondemand') {\n\t\t\t\t\t\tondemandApps.push(appGroup)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconsole.log(ondemandApps)\n      }, (err) => {\n        this.error = err //.data.error + \" [\"+err.status+\"]\";\n\n        console.warn('error', err)\n        let body = '<h1>Error</h1><pre>' + JSON.stringify(err, null, \" \") + \"</pre>\"\n      })\n\t}\n}\n\nHelloCtrl.templateUrl = 'module.html';\n"]}